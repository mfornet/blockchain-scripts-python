"""
Simple borsh implementation similar to implementation in solidity.
"""

data = bytes.fromhex("3c00000010000000616c65782e706f6f6c76312e6e656172003e1e92fc7664a1c2e373ece96edb3530146a5a5b3592466150fe7e79555f093f9912ca2e29ac50e9edc9cc6634000000130000006c6567656e64732e706f6f6c76312e6e65617200b7c1da5ee0b4df4319d67e9ee00812638fc61ac9525555225dbf421e7932b4382d42d7e0042fffc8770dbd2f3300000017000000626c6f636b6461656d6f6e2e706f6f6c76312e6e6561720021a71cb90c0fef940105eb5eaef5c2ae5cd936144488509d6e8a4578fe4d975b8477c0784245c2ba429fbd595f0000001a00000062696e616e63657374616b696e672e706f6f6c76312e6e65617200effba86fc6b23039ee7de88d64489f5d9b4cea7904ff65f21b9a81d524fdb3a43c2bcca233f750aeb52d10836a000000120000007374616b65642e706f6f6c76312e6e65617200221e1c61ad8e994161ec7f3a34b9e3c13ec5971a8e6fab43eb0765cafb9e1c8c53948ee1b56f590c7daf82cbfe01000010000000657069632e706f6f6c76312e6e656172004c27dd137dc829e91aaf5e76f85bdc7115f33deea898e4f590339d168842fb580a879df44575b050107712c1a400000019000000617374726f2d7374616b6572732e706f6f6c76312e6e656172001a7c308abd0a4197512b9c06be92eddca33ce2c52bae8c2a76929f5cac85364df6ef29e5a613b46749dad7ead1000000140000006e65617266616e732e706f6f6c76312e6e65617200e407e0cad34baa9b99b02c8d7d4e49877ca40808ac1daaeac3a44a8bc20c8282ce0a972647f80d864971c19035000000160000006275696c646c696e6b732e706f6f6c76312e6e65617200f6f6fa2a4ba86f396ee260af5944ed052d33f527f25ddd49d6e01154f6d1e691d4cc26dbe8deb147c22e0fc371000000170000006269736f6e747261696c732e706f6f6c76312e6e65617200cc9e38be807372a56b313a2bbed6f3281613d17ad70e99b1bdce57ff599a28e399764f36b9e073d99644fb4c0f010000130000007032702d6f72672e706f6f6c76312e6e65617200fd5ed2a09cde75c5ef94e81946244fc72b41b7da31875065afbfa623d673305d57e9094f4d44d0c7f36aa1532d000000130000007a61766f64696c2e706f6f6c76312e6e65617200f1def18f6b0d1e1a0dddea91e446ab4fb346c9774e0590995e5d6f79536bdca35d6010bf5f18c4afdbbcd86c93000000110000006d616769632e706f6f6c76312e6e656172004568e72fa4142036da15a73c9e85dac296941c22b50175b0d60c82cbac4e08ff6c5b805b8f9a77ee4feb90f98700000015000000737061726b706f6f6c2e706f6f6c76312e6e656172003093ba4e68188ef312fe486a63d9dc44fa65eb63056f0566c90b7b82af48421d7fe63f5364b791b62ef977f732000000160000006f70656e7368617264732e706f6f6c76312e6e6561720034745a9187778a5c24c7f8084c3b70557c78435c08bf53834dd0530de7187a463549785970c371192fa3e998570000001000000072656b742e706f6f6c76312e6e65617200dbd729c3562f9eaafd610895568b901c0eaa07548255955c611fb029b74d2d4b4bd163e8fa23d275c8b3a31f74000000150000006e65617263726f77642e706f6f6c76312e6e65617200f73cb9d75a5ccbb07792410ea4d2547dcdcf2d9bee6eebe820162730e852b86ecfa17a763cfa8df3e05d54f15900000018000000646f6b69616361706974616c2e706f6f6c76312e6e65617200d4033db7237eeb60672d497ce869a39f729b9d0ad1ccfc213c8e530860c2b4031f25f44cad7387446f5e649638000000160000006163636f6d706c6963652e706f6f6c76312e6e656172004496b796a986600add7f4af6c53a6f83200079df6739f91db504fef07e40507e2b2ec7a7ff11389ec70520764200000015000000647261676f6e666c792e706f6f6c76312e6e656172004e51c7971f29de1536c1d4ad8d4f5d2645214d940979b0e16658d3c900df74fa3ec285ffc2489556eb0dd509e000000016000000736861727064617274732e706f6f6c76312e6e656172007ea3db25775a4aab64d5e11a8092fd7ef28e2b67992061ac6fa37212d856a55850b81a3a58a031e8699541e6330000001500000061756469745f6f6e652e706f6f6c76312e6e6561720084f5f515910f8853101f393fc680f415b7bef71a6dcb0cf4f4164326c3a2748d44a38168446ae55de70ba06e2e000000150000006365727475736f6e652e706f6f6c76312e6e6561720037d4a1246439b4534c7109961cd074ebd448048ccd350d0a3fe6f5b8de61c5b5177b49d7ecc638d34ec577ff300000001200000073776564656e2e706f6f6c76312e6e656172003a9c445cabc9b3870577d3b1958624b69936995fc4c4fae71b369525e1eeaeab6261e2d85ee7c76e70cb7abb2d0000001700000062617a696c696b6e6561722e706f6f6c76312e6e65617200c202575c4fa0b042afb81d27d3ff71111f4f0b1560608075da18244751002dc9c22919e77cd7ea76a3c692e332000000250000007a6b765f7374616b65746f737570706f7274707269766163792e706f6f6c76312e6e6561720019eabcb8f1683eb466388a9c11820582c8af5989026f3eec5634b98eb3d1ee7d56cfca6ae70e912c0600ca34310000000f00000065726d2e706f6f6c76312e6e656172006a00a3e228258e4ee40376df56dc39a81b2d79b478303163f5dbbe90f8c2ef3a74ce9da0dbbb748d86f76ba52f00000017000000736d6172742d7374616b652e706f6f6c76312e6e65617200873f13407a5c377e076c6151a0fe80f277a5b9194cd9d07dce11448f05a181832e44e6121cd9aca6489f11a12b0000001700000063727970746f74726962652e706f6f6c76312e6e65617200f83f63bddc7b3f76fa1748de523ea39ae1509314fb6b8f2b717e881ad408f2d02df60bdba37b5c35142cfd8c2e000000130000006e6f64656173792e706f6f6c76312e6e656172007377978f3b1738413cfc96cd0d5b6077e2014fc9d7750eb59f4d3f61f1d51636228b096aa401d47a166c786d2d0000000f0000006c75782e706f6f6c76312e6e65617200fc72cbe55b5cd0da612f205e7cd21b0f29131ae53ecc9111efb45526de9771016b40c69187002fc1076edf42360000001d000000746f7474656e68616d5f686f74737075722e706f6f6c76312e6e6561720039a0f2fc613f3365bfbaf2224423b7b3cfbba93dd6b0aee5c87894c2d26371d0c55d19e7a47db451af53af12380000001500000063686f7275736f6e652e706f6f6c76312e6e656172008e29293031ae6e8e3da83c21a5eacd63326eaf7a26962b4cabfc9519f48ccf8abe218d8127c0ec0e886419a04f000000140000006e656172383838382e706f6f6c76312e6e656172004249e314bd715a18493a6f05ab2a133f5b6bc20d437a347256aa77e6dc8878b0843795d844a415a921e01fbf3d0000001400000073746172647573742e706f6f6c76312e6e6561720057164dac1e16bcaca82200fa4fcc7fc67d785509840805ecd6cfdd14da9342b099b90f2a1026d9ee1a9584af4c000000140000006c756e616e6f76612e706f6f6c76312e6e656172000c7d3f4fbf5a3a9bf14fbeaab8fbdbe89418b48136dd91f33ff7580e0d4a3a0d2308b32bb267b03a3778826c3000000014000000656c6563747269632e706f6f6c76312e6e65617200eb06d38294f4ed9ab87c4c809c3cbe4e60c39bdf515394d92f51e12897e10f0a12c26cea285f7d5e84f39955810000000e00000064312e706f6f6c76312e6e6561720061865578d21f0531845f722c7ac4fd0d6784ad7e6845ffbe26592f725589cb538460e34ec19759229792499b6700000014000000637279707469756d2e706f6f6c76312e6e6561720043699687585941d745ff33e72e9c52441d458da236a0771e7f47f31428b2fd45b75fe6cd2f2af6c1f17721273b000000120000007374616b696e2e706f6f6c76312e6e656172006926f74d3650b4e133d6135a540ec8b748bf4ddb498011b2553fb73aac8ea93d103f8f7f9657bd7ff1a080784f00000014000000647372766c6162732e706f6f6c76312e6e656172007d4f6b36d0f5e1e7f94893f58b2d64e5fb975dd0b9982e93313bf402c608a27f71d708990a20954884692e5f2f000000130000006170706c6f61642e706f6f6c76312e6e656172004f4f50377ae2b56ca5c170a46739846f65930e2a55b00701a1f8aeb02c194a1a49dc7760ca87e75dce6f6b602d000000160000007374616b6573616261692e706f6f6c76312e6e6561720052e5b4c8e546a67d15cbb456437ccc53d364995dcd98089bb42f1a0ec2bc28dccddf16d438512bad0570c6753300000010000000666973682e706f6f6c76312e6e65617200107a424baf43b10e65c6b0f163a06142160c239fe0e5d99931fcff622312c285ff7c35ad10c191a4fdb44cf7390000002c0000003038696e76657374696e776f6d656e5f72756e62796269736f6e747261696c732e706f6f6c76312e6e65617200a4f8bbe834c1f851ab19a8cb9bb0f347cd442a9e5c1d559ee980e5d41de351103c4995d2f6a0970ea670721a4400000015000000616e6f6e796d6f75732e706f6f6c76312e6e65617200f9b3523695ef7c8fe97ff9667f434d1572d69445970a32f2b88a70ed64424a1b12e25e1c65414b0d7891e71e4f0000001400000061626c5f706f6f6c2e706f6f6c76312e6e656172004729d3125869916bb890a5f1838b0377a0f25edfb2e20ef5c12edf4be8433c83cb8b9d6d2193275fd4895cd63b0000001100000066726573682e706f6f6c76312e6e65617200524de964c235c8d7a082c89b489da77f8851e524aded4d7d59e7826a42883d96c897a474cea8bcdeefcc59112d000000130000006669676d656e742e706f6f6c76312e6e656172005f7ca7150148f789c25259d3c4c7a77e32dc9596cb22eb26e893672f5ff0103e6bd3c13a18ddb558f2a1145b3e000000110000006a617a7a612e706f6f6c76312e6e65617200c89b878a95c940d23d24723abb19b3dede978c78db2d69853559cbdb9dec4f633399f95e823349360989ffc02b00000014000000636f6e74696e75652e706f6f6c76312e6e6561720083792a9e0955b5c6f3e2952d14205ec34ed113f1a1dedb2c0615714da6f02c9c6131de632ccf57508c6aa3c249000000130000006d6f6f6e6c65742e706f6f6c76312e6e65617200e9f1eb4ceecb07bc5e8be86ed72fd0d9dae6082c0bfb1515a1426c10b51717f65e293402f3025c0b6b005b882b0000001100000066696e6f612e706f6f6c76312e6e65617200b163cd1823693775dda20c318139777cb01557f0a126cba6d9deed7d250b4d0fadf541f71f64a1464dd3cf2175000000180000006d61737465726e6f646532342e706f6f6c76312e6e6561720043e14e842536da53cb620ec724375540715f46ab21e9b651b31dd0c574affb473c9f2d06ace014f988f5dd892d00000015000000657665727374616b652e706f6f6c76312e6e656172003104782f5d324849d18fceb128e7d078728dd36b9e4783d3f5a487d0752f921d03d36b90e56bca68e169f03e2e0000001200000030316e6f64652e706f6f6c76312e6e6561720049c6438ba40e3aac837cd6b74d728355d3cd998ee7b96270af89e63c1155ad07bb4c891f5a6afd8ac33c64153c0000001a0000006e6f72746865726e6c69676874732e706f6f6c76312e6e656172005d621e09311356596e924d6d605fcbae0feff30f0ad47714519b8588dbaac6ba9d74f3d06525fca5d0474c164600000012000000696e6f74656c2e706f6f6c76312e6e65617200bda0bd796992a2bafcfefcd79459ad77019a7cad5fa2ffae09088ef8a96f58413d7e22253adf3254aefabe19300000001500000068617368717561726b2e706f6f6c76312e6e6561720025b6aa02bde3898aec6e53bffcad0bfaa2e6bada2cc5962cba35def6cc65d17ea41986539919c67ff1ab0c9a2f0000001600000068623433365f706f6f6c2e706f6f6c76312e6e65617200650d6e12a1e2ba54ae42e43f5fa20e8cc19d22c488e40314c4cff6009c5f487f9e622d10390fd81a9a23c7d944000000")


def check_good(inner):
    def func(self):
        res = inner(self)
        assert(self.pnt <= len(self.data))
        return res
    return func


class BorshView:
    def __init__(self, data):
        self.data = data
        self.pnt = 0

    def done(self):
        return self.pnt == len(self.data)

    @check_good
    def decodeU8(self):
        value = self.data[self.pnt:self.pnt + 1]
        self.pnt += 1
        return int(bytes(reversed(value)).hex(), 16)

    @check_good
    def decodeU32(self):
        value = self.data[self.pnt:self.pnt + 4]
        self.pnt += 4
        return int(bytes(reversed(value)).hex(), 16)

    @check_good
    def decodeU128(self):
        value = self.data[self.pnt:self.pnt + 16]
        self.pnt += 16
        return int(bytes(reversed(value)).hex(), 16)

    @check_good
    def decodeBytes32(self):
        value = self.data[self.pnt:self.pnt + 32]
        self.pnt += 32
        return value

    @check_good
    def skip(self):
        length = self.decodeU32()
        self.pnt += length

    @check_good
    def decodePK(self):
        assert self.decodeU8() == 0
        return self.decodeBytes32()

    @check_good
    def decodeBlockProducer(self):
        self.skip()
        pk = self.decodePK()
        stake = self.decodeU128()
        return pk, stake


data = BorshView(data)

total = data.decodeU32()
for i in range(total):
    (pk, stake) = data.decodeBlockProducer()
    print(i, pk.hex(), stake)

assert data.done()
